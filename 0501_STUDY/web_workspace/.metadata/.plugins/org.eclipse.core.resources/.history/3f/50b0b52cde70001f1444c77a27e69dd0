<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>다음 지도 API - 경로 표시</title>
<style>
    #map { width: 100%; height: 100vh; }
    #controls { position: absolute; top: 10px; left: 10px; background: white; padding: 10px; border-radius: 5px; }
    #controls input { margin-bottom: 5px; }
</style>
</head>
<body>
    <div id="controls">
        <input type="text" id="start" placeholder="시작지" />
        <input type="text" id="via" placeholder="경유지 (선택)" />
        <input type="text" id="end" placeholder="도착지" />
        <button onclick="findRoute()">경로 찾기</button>
    </div>
    <div id="map"></div>

    <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=c97889f438939687969d7a54a445021f&libraries=services"></script>
    <script>
        var mapContainer = document.getElementById('map');
        var mapOption = {
            center: new kakao.maps.LatLng(37.60630, 127.02405),
            level: 8
        };
        var map = new kakao.maps.Map(mapContainer, mapOption);
        
        var directionsService = new kakao.maps.services.Directions();

        function findRoute() {
            var start = document.getElementById('start').value;
            var via = document.getElementById('via').value;
            var end = document.getElementById('end').value;

            directionsService.route({
                origin: start,
                destination: end,
                waypoints: via ? [{ location: via }] : [],
                travelMode: kakao.maps.services.TravelMode.DRIVING
            }, function(result, status) {
                if (status === kakao.maps.services.Status.OK) {
                    var route = result.routes[0];
                    var path = route.path;
                    
                    // 기존의 폴리라인이 있으면 제거
                    if (polyline) {
                        polyline.setMap(null);
                    }

                    // 새로운 폴리라인을 생성
                    polyline = new kakao.maps.Polyline({
                        path: path,
                        strokeWeight: 5,
                        strokeColor: '#FF0000',
                        strokeOpacity: 0.7,
                        strokeStyle: 'solid'
                    });

                    // 지도에 폴리라인 표시
                    polyline.setMap(map);

                    // 경로가 포함된 영역을 자동으로 확대하여 지도에 표시
                    var bounds = new kakao.maps.LatLngBounds();
                    for (var i = 0; i < path.length; i++) {
                        bounds.extend(path[i]);
                    }
                    map.setBounds(bounds);
                } else {
                    alert('경로를 찾을 수 없습니다.');
                }
            });
        }

        var polyline;
    </script>
</body>
</html>
